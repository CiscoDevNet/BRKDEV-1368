hostname iosxe4
!
interface Loopback0
 ip address 4.4.4.4 255.255.255.255
!
interface Loopback101
 ip address 172.16.28.1 255.255.255.0
!
interface Loopback102
 ip address 172.16.29.1 255.255.255.0
!
interface Loopback103
 ip address 172.16.30.1 255.255.255.0
!
interface Loopback104
 ip address 172.16.31.1 255.255.255.0
!
interface GigabitEthernet2
 ip address 10.0.0.6 255.255.255.252
 negotiation auto
 no mop enabled
 no mop sysid
 no shut
!
interface GigabitEthernet3
 ip address 10.0.0.14 255.255.255.252
 negotiation auto
 no mop enabled
 no mop sysid
 no shut
!
interface GigabitEthernet4
 ip address 10.200.200.2 255.255.255.252
 negotiation auto
 no mop enabled
 no mop sysid
 no shut
!
router ospf 200
 router-id 4.4.4.4
 redistribute connected subnets
 network 10.200.200.0 0.0.0.3 area 0
 network 172.16.28.0 0.0.3.255 area 0
!
router bgp 96000
 bgp router-id 4.4.4.4
 bgp log-neighbor-changes
 neighbor 10.0.0.5 remote-as 65512
 neighbor 10.0.0.13 remote-as 65512
 neighbor 10.200.200.1 remote-as 96000
 !
 address-family ipv4
  network 172.16.28.0 mask 255.255.255.0
  network 172.16.29.0 mask 255.255.255.0
  network 172.16.30.0 mask 255.255.255.0
  network 172.16.31.0 mask 255.255.255.0
  neighbor 10.0.0.5 activate
  neighbor 10.0.0.5 soft-reconfiguration inbound
  neighbor 10.0.0.5 route-map FROM_IOSXE1 in
  neighbor 10.0.0.5 route-map TO_IOSXE1 out
  neighbor 10.0.0.13 activate
  neighbor 10.0.0.13 soft-reconfiguration inbound
  neighbor 10.0.0.13 route-map FROM_IOSXE2 in
  neighbor 10.0.0.13 route-map TO_IOSXE2 out
  neighbor 10.200.200.1 activate
  neighbor 10.200.200.1 next-hop-self
  neighbor 10.200.200.1 soft-reconfiguration inbound
  neighbor 10.200.200.1 route-map FROM_IOSXE3 in
  neighbor 10.200.200.1 route-map TO_IOSXE3 out
 exit-address-family
!
ip prefix-list FROM_IOSXE2 seq 5 permit 192.168.16.0/22 le 24
!
ip prefix-list LOOPS seq 5 permit 172.16.28.0/22 le 24
!
!
route-map FROM_IOSXE1 permit 1000
!
route-map FROM_IOSXE3 permit 1000
!
route-map FROM_IOSXE2 permit 10
 match ip address prefix-list FROM_IOSXE2
 set local-preference 200
!
route-map FROM_IOSXE2 permit 1000
!
route-map TO_IOSXE1 permit 10
 match ip address prefix-list LOOPS
 set as-path prepend 96000 96000
!
route-map TO_IOSXE1 permit 1000
!
route-map TO_IOSXE2 permit 1000
!
route-map TO_IOSXE3 permit 1000
